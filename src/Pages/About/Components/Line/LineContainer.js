import { useEffect, useRef, useState } from "react";
import { LineStyled } from "./LineStyled";

export default function LineContainer() {
  const line = useRef(null);
  const [shown, setShown] = useState(false);

  function animateOnScroll(value) {
    console.log("value", value);
    var line_total_length = line.current.getTotalLength();

    line.current.style.strokeDasharray = line_total_length; // Get the starting position of the draw.
    line.current.style.strokeDashoffset = line_total_length;
    var draw = line_total_length * value;
    line.current.style.strokeDashoffset = line_total_length - draw;
  }
  useEffect(() => {
    const handleScroll = () => {
      setShown(true);
      const value = window.scrollY / 2100;
      animateOnScroll(value);
    };

    window.addEventListener("scroll", handleScroll);

    return () => {
      window.removeEventListener("scroll", handleScroll);
    };
  }, []);
  return (
    <LineStyled>
      {shown && (
        <svg
          width={237}
          height={2736}
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          preserveAspectRatio="xMidYMax meet"
        >
          <path
            ref={line}
            d="M106 0V276.651C106 323.249 129.879 366.597 169.266 391.497L174.641 394.895C258.138 447.683 256.187 570.119 171.05 620.22C130.746 643.938 106 687.212 106 733.978V805.733C106 824.051 117.103 840.54 134.076 847.429L188.028 869.329C192.488 871.139 192.065 877.587 187.407 878.8L106 900L30.3521 879.881C25.3862 878.56 25.4037 871.506 30.3762 870.21L104.332 850.935C105.413 850.653 106.557 850.741 107.582 851.186L158.683 873.345C160.767 874.248 161.681 876.703 160.697 878.749L143.5 914.5L131.44 919.967C115.219 927.321 96.626 927.667 80.3494 920.437C71.5281 916.518 63.4756 912.765 62 911.5C58.5 908.5 53 886.5 53 886.5L35.2545 881.83C34.6204 881.663 34 882.142 34 882.797V909.412C34 909.775 34.1969 910.109 34.5144 910.286L37.6965 912.054C38.1508 912.306 38.3361 912.864 38.1228 913.338L35.0725 920.117C34.696 920.953 33.4858 920.884 33.2076 920.01L31.2646 913.903C30.99 913.04 31.9122 912.286 32.7036 912.726L106 953.5V1040.14V1142.2C106 1168.32 95.6223 1193.38 77.1503 1211.85C38.6833 1250.32 38.6833 1312.68 77.1503 1351.15L98.0003 1372C147.982 1421.98 147.982 1503.02 98.0003 1553C48.0183 1602.98 48.0183 1684.02 98.0003 1734L130.164 1766.16C162.382 1798.38 162.382 1850.62 130.164 1882.84C122.503 1890.5 116.426 1899.59 112.28 1909.6C108.134 1919.61 106 1930.34 106 1941.17V1941.17C106 1959.09 110.624 1976.7 119.424 1992.31L129.211 2009.66C153.456 2052.66 146.892 2106.5 112.444 2141.85C90.5673 2164.31 67.5195 2187.54 53.3223 2200.65C-16.9147 2265.51 -16.9147 2376.49 53.3223 2441.35C69.9328 2456.69 83.1882 2475.3 92.2542 2496.01C101.32 2516.73 106 2539.09 106 2561.7V2708.5C106 2723.14 94.1353 2735 79.5003 2735C64.8653 2735 53.0003 2723.14 53.0003 2708.5V2701.75C53.0003 2683.39 67.8863 2668.5 86.2503 2668.5H101.114C116.239 2668.5 128.5 2680.76 128.5 2695.89V2716C128.5 2732.98 107.976 2741.48 95.9733 2729.47C88.5333 2722.03 88.5333 2709.97 95.9733 2702.53L101 2697.5C107.904 2690.6 119.096 2690.6 126 2697.5L132.349 2703.85C133.157 2704.66 133.798 2705.62 134.235 2706.67C134.672 2707.73 134.897 2708.86 134.897 2710C134.897 2711.14 134.672 2712.27 134.235 2713.33C133.798 2714.38 133.157 2715.34 132.349 2716.15L128 2720.5C124.125 2724.37 117.5 2721.63 117.5 2716.15V2713C117.5 2711.34 116.157 2710 114.5 2710H112.75C112.06 2710 111.5 2710.56 111.5 2711.25V2711.5C111.5 2712.05 111.948 2712.5 112.5 2712.5C113.052 2712.5 113.5 2712.05 113.5 2711.5"
            stroke="#000"
          />
        </svg>
      )}
    </LineStyled>
  );
}
